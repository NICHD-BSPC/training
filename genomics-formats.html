
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Genomics overview</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/better.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Variant calling" href="variant-calling.html" />
    <link rel="prev" title="Biology" href="biology.html" />


  <link href="https://fonts.googleapis.com/css?family=Lato|Lato:bold,italic,bolditalic|Lora|Oswald|Inconsolata&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <link rel="stylesheet" href="_static/style.css" type="text/css" />
  </head><body>
    <header id="pageheader"><h1><a href="index.html ">
        
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="biology.html" title="Previous document">Biology</a>
        </li>
        <li>
          <a href="variant-calling.html" title="Next document">Variant calling</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">Home</a></li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="genomics-overview">
<span id="genomics-formats"></span><h1>Genomics overview<a class="headerlink" href="#genomics-overview" title="Permalink to this heading">¶</a></h1>
<section id="overviews">
<h2>Overviews<a class="headerlink" href="#overviews" title="Permalink to this heading">¶</a></h2>
<p>Recent reviews are probably the best place to get an overview of
high-throughput sequencing.The goal is not to understand everything
discussed in these reviews, rather, the goal is to get exposed to
terminology, get a big-picture overview of the process and limitations,
and prime yourself for further reading. You’ll probably get a lot more
out these by re-reading them after you gain some experience. The rest of
this page will be about the specifics, and getting more experience.</p>
<p>This review article from Molecular Cell
(<a class="reference external" href="https://www.cell.com/molecular-cell/fulltext/S1097-2765(15)00340-8">https://www.cell.com/molecular-cell/fulltext/S1097-2765(15)00340-8</a>)
gives a good overview of high-throughput sequencing. It’s fairly
up-to-date, comparing Illumina with Pac Bio, Nanopore, and Ion Torrent
as well as giving a brief overview of the kinds of assays that are
commonly performed.</p>
<p>Here are some recent reviews on specific assays:</p>
<ul class="simple">
<li><p>Review on RNA-seq:
<a class="reference external" href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0881-8">https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0881-8</a></p></li>
<li><p>Review on ChIP-seq:
<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5444249/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5444249/</a></p></li>
<li><p>Review on SNV calling:
<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5852328/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5852328/</a></p></li>
<li><p>2016 review of sequencing technology:
<a class="reference external" href="https://www.nature.com/articles/nrg.2016.49">https://www.nature.com/articles/nrg.2016.49</a></p></li>
</ul>
<p>The site <a class="reference external" href="http://education.knoweng.org/sequenceng/">“SequencEng”</a> has
interactive flowcharts of high-throughput sequencing techniques, along with
tool suggestions. This can be useful for getting a big-picture view of the
steps of various workflows.</p>
</section>
<section id="genome-browsers">
<h2>Genome Browsers<a class="headerlink" href="#genome-browsers" title="Permalink to this heading">¶</a></h2>
<p>As with any data analysis, the first thing you should do with your data
is to visualize it. Genomic data is no different, so it makes sense that
the first thing to learn about high-throughput sequencing is how to
visualize it. When we look at file formats below, loading them in a
genome browser will help you understand them better.</p>
<p>You will probably always be learning new things about these browsers;
for now just install/load them and poke around to get a feel for them.
Below we’ll upload specific files to experiment with.</p>
</section>
<section id="igv">
<h2>IGV<a class="headerlink" href="#igv" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://software.broadinstitute.org/software/igv/">https://software.broadinstitute.org/software/igv/</a></p>
<p>IGV (Integrated Genome Viewer) is a standalone Java program. It’s best used for
local data, and excels at detailed looks at BAM and VCF files. Since it can
read files straight off disk, this is the preferred option for data that can’t
be made public.</p>
</section>
<section id="ucsc-genome-browser">
<h2>UCSC Genome Browser<a class="headerlink" href="#ucsc-genome-browser" title="Permalink to this heading">¶</a></h2>
<p><a class="reference external" href="https://genome.ucsc.edu/">https://genome.ucsc.edu/</a></p>
<p>The UCSC Genome Browser is a web-based browser. It looks like the design
hasn’t changed since the 90s, but it is extremely powerful and is
constantly updated. It has a tremendous amount of data already loaded,
and is best used for sharing data with others or comparing with existing
data.</p>
</section>
<section id="other-genome-browsers">
<h2>Other genome browsers<a class="headerlink" href="#other-genome-browsers" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.bioinformatics.babraham.ac.uk/projects/seqmonk/">SeqMonk</a> has
some interesting visualization options</p></li>
<li><p><a class="reference external" href="http://epigenomegateway.wustl.edu/browser/">WashU Epigenome Viewer</a> allows
visualization of long-range interaction data like Hi-C</p></li>
</ul>
</section>
<section id="file-formats">
<h2>File formats<a class="headerlink" href="#file-formats" title="Permalink to this heading">¶</a></h2>
<p>The field has settled down into a reasonably small set of file formats
that are commonly used by various tools. Getting to know these file
formats and what they are used for is important for understanding how to
use various tools. Some exercises are provided below to reinforce what
you’ve learned in “Getting started on the command line”. There are some
useful hints provided as well.</p>
<p>For example, an RNA-seq experiment will start with FASTQ files from the
sequencer. You’ll need to align these to the genome to create BAM files, and
then count reads in genes where the gene annotations are provided in a GTF
file.</p>
<p>For a ChIP-seq experiment, you’ll start with FASTQ files, align them to the
genome to get a BAM, and then call peaks to get BED files you can view in
a genome browser.</p>
<p>For variant calling, you’ll start with FASTQ files, align them to the genome to
get a BAM, and run variant-calling tools to get a VCF file you can view in
a genome browser.</p>
<section id="an-aside">
<h3>An aside<a class="headerlink" href="#an-aside" title="Permalink to this heading">¶</a></h3>
<p>Some of the file formats described below are position-based. Please read the
following posts talking about 0-based and 1-based coordinate systems to figure
out what this means:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://standage.github.io/on-genomic-interval-notation.html">https://standage.github.io/on-genomic-interval-notation.html</a></p></li>
<li><p><a class="reference external" href="https://www.biostars.org/p/84686/">https://www.biostars.org/p/84686/</a></p></li>
</ul>
</section>
<section id="fastq">
<h3>FASTQ<a class="headerlink" href="#fastq" title="Permalink to this heading">¶</a></h3>
<p>Raw reads come off the sequencer in FASTQ format. Each read is
represented by 4 lines only one of which is the sequence itself. Note
that there is no genomic position information in a FASTQ file. It has to
be aligned to a reference sequence to figure out where each read came
from. The wikipedia page on FASTQ is probably the best resource for
learning about this format and its sometimes-frustrating idosyncracies:
<a class="reference external" href="https://en.wikipedia.org/wiki/FASTQ_format">https://en.wikipedia.org/wiki/FASTQ_format</a>.</p>
<p>Here is an example FASTQ file, gzipped:
<a class="reference external" href="https://github.com/lcdb/lcdb-test-data/raw/master/data/rnaseq_samples/sample1/sample1.tiny_R1.fastq.gz">https://github.com/lcdb/lcdb-test-data/raw/master/data/rnaseq_samples/sample1/sample1.tiny_R1.fastq.gz</a></p>
<p>Since FASTQ files do not have coordinates, we cannot visualize these
files in a genome browser.</p>
<ul class="simple">
<li><p>How many reads are in this FASTQ file? (command at the bottom of this
page if you need help)</p></li>
<li><p>What quality score encoding does it use?</p></li>
</ul>
</section>
<section id="bam">
<h3>BAM<a class="headerlink" href="#bam" title="Permalink to this heading">¶</a></h3>
<p>When FASTQ files are aligned to a reference genome, the output is
typically a BAM format file (or sometimes the uncompressed version, SAM
files). There is lots of information in each line of a BAM file. The BAM
specification <a class="reference external" href="https://samtools.github.io/hts-specs/SAMv1.pdf">https://samtools.github.io/hts-specs/SAMv1.pdf</a> gives
excruciating detail on this format, but is worth reading through. You
will probably re-read that document many times over your career, don’t
worry if you don’t fully understand it! Important parts to grasp this
time around are the FLAG field, where and how genomic coordinates are
stored, and that chromosome information is stored in the header int the
&#64;SQ lines. Section 1 is the most important part:</p>
<p>To experiment with visualization, scroll down to Example #1 on this
page: <a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/bam.html">https://genome.ucsc.edu/goldenPath/help/bam.html</a>, and view the BAM
in UCSC Genome Browser.</p>
<p>Then download the BAM file from that example
(<a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/examples/bamExample.bam">https://genome.ucsc.edu/goldenPath/help/examples/bamExample.bam</a>). You
will also need to download the index
(<a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/examples/bamExample.bam.bai">https://genome.ucsc.edu/goldenPath/help/examples/bamExample.bam.bai</a>,
more on indexes later). Then load the BAM into IGV.</p>
<ul class="simple">
<li><p>how do the browsers display the same data differently?</p></li>
</ul>
<p>BAM files are compressed in a very specific way. To read them correctly,
we need to use the samtools program. See the More on installing programs
section for ways of installing it (either manually, load a module on
Biowulf, or conda install samtools). Then, use the samtools view program
to view it (hint: probably want to pipe to head or less).</p>
<p>Hint: the column command helps nicely print tab-delimited files, and the
-S argument to less ignores wrapping. So a convenient way of viewing BAM
files on the command line is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>samtools<span class="w"> </span>view<span class="w"> </span>bamExample.bam<span class="w"> </span><span class="p">|</span><span class="w"> </span>column<span class="w"> </span>-t<span class="w"> </span><span class="p">|</span><span class="w"> </span>less<span class="w"> </span>-S
</pre></div>
</div>
<ul class="simple">
<li><p>how many reads are in this BAM file?</p></li>
</ul>
<p>We will do some more exercises on this BAM file in the samtools section.</p>
</section>
<section id="bed">
<h3>BED<a class="headerlink" href="#bed" title="Permalink to this heading">¶</a></h3>
<p>BED files represent blocks of coordinates in the genome. While FASTQ and
BAM are primarily used for sequences, BED files can represent anything
that can be described in terms of genomic coordinates (chromsome, start
position, stop position). This can be protein binding sites, genes,
transcripts, primers, or simply loci of interest. BED files can be
simple 3-column files or can be more complicated with 12 columns. Given
their simplicity they are probably one of the most common of the
interval formats.</p>
<p>BED format description:
<a class="reference external" href="https://genome.ucsc.edu/FAQ/FAQformat.html#format1">https://genome.ucsc.edu/FAQ/FAQformat.html#format1</a>. Be sure to try out
the examples there as well to visualize BED files. Try changing the
example files to see how the visualization changes.</p>
<p>Here’s another BED files to experiment with. These are ChIP-seq peaks
for a protein called CP190 in Drosophila:
<a class="reference external" href="https://raw.githubusercontent.com/daler/pybedtools/master/pybedtools/test/data/Cp190_Kc_Bushey_2009.bed">https://raw.githubusercontent.com/daler/pybedtools/master/pybedtools/test/data/Cp190_Kc_Bushey_2009.bed</a></p>
<ul class="simple">
<li><p>how many peaks are there?</p></li>
<li><p>how many peaks are there on each chromosome?</p></li>
</ul>
</section>
<section id="gtf-and-gff">
<h3>GTF and GFF<a class="headerlink" href="#gtf-and-gff" title="Permalink to this heading">¶</a></h3>
<p>While BED files can represent genes, there is no good way for a BED file
to represent hierarchical relationships between features. However GTF
and GFF files do allow this. For example they can encode which exons
belong to which transcripts and which transcripts belong to which gene.
Even though each individual line is not much more complex than a BED
file, the file overall is more complicated due to the hierarchical
connections between lines. GTF and GFF files are most commonly used when
when counting reads in genes during RNA-seq analysis, though any time
you’re working with gene annotations they are likely to be found in GFF
or GTF format.</p>
<p>GTF format description: <a class="reference external" href="http://mblab.wustl.edu/GTF22.html">http://mblab.wustl.edu/GTF22.html</a></p>
<p>GFF format description:
<a class="reference external" href="https://useast.ensembl.org/info/website/upload/gff.html">https://useast.ensembl.org/info/website/upload/gff.html</a></p>
<p>To practice, try the GTF example on UCSC:
<a class="reference external" href="https://genome.ucsc.edu/FAQ/FAQformat.html#format4">https://genome.ucsc.edu/FAQ/FAQformat.html#format4</a>. Note that UCSC’s GFF
format is a really old version of the format; converting a typical GFF
to work on UCSC is outside the scope of this exercise.</p>
<p>Here’s another example file. This will not work directly in UCSC, but
you can look at it in the command line (note it is gzipped):
<a class="reference external" href="https://github.com/daler/pybedtools/raw/master/pybedtools/test/data/dm3-chr2L-5M.gff.gz">https://github.com/daler/pybedtools/raw/master/pybedtools/test/data/dm3-chr2L-5M.gff.gz</a></p>
<ul class="simple">
<li><p>how many features?</p></li>
<li><p>what is the most common feature type?</p></li>
</ul>
<p>Parsing the attributes field of GTF/GFF gets pretty annoying; we’ll hold
off on that for now.</p>
</section>
<section id="vcf">
<h3>VCF<a class="headerlink" href="#vcf" title="Permalink to this heading">¶</a></h3>
<p>VCF files are used for storing variant information and the additional
metadata that goes along with it. Typically, any kind of variant-calling
involves VCF files.</p>
<p>VCF format description: <a class="reference external" href="https://samtools.github.io/hts-specs/VCFv4.2.pdf">https://samtools.github.io/hts-specs/VCFv4.2.pdf</a>.
Lots of details and terminology here!</p>
<p>To practice, scroll down to Example #1 on this page to visualize:
<a class="reference external" href="https://genome.ucsc.edu/goldenPath/help/vcf.html">https://genome.ucsc.edu/goldenPath/help/vcf.html</a></p>
<p>That example has a lot samples; a smaller one that’s easier to look at
is
<a class="reference external" href="https://raw.githubusercontent.com/vcflib/vcflib/master/samples/sample.vcf">https://raw.githubusercontent.com/vcflib/vcflib/master/samples/sample.vcf</a>.
In that example:</p>
<ul class="simple">
<li><p>which line has a quality score &lt;10?</p></li>
<li><p>which variant has the highest total depth of coverage?</p></li>
<li><p>which variant has the highest genotype quality?</p></li>
</ul>
</section>
</section>
<section id="standard-tools">
<h2>Standard tools<a class="headerlink" href="#standard-tools" title="Permalink to this heading">¶</a></h2>
<section id="samtools">
<h3>samtools<a class="headerlink" href="#samtools" title="Permalink to this heading">¶</a></h3>
<p>BAM files are compressed in a very specific way. To read them correctly,
we need to use the samtools program. See the More on installing programs
section for ways of installing it (either manually, load a module on
Biowulf, or conda install samtools). Then, use the samtools view program
to view it (hint: probably want to pipe to head or less).</p>
<p>Hint: the column command helps nicely print tab-delimited files, and the
-S argument to less ignores wrapping. So a convenient way of viewing BAM
files on the command line is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>samtools<span class="w"> </span>view<span class="w"> </span>bamExample.bam<span class="w"> </span><span class="p">|</span><span class="w"> </span>column<span class="w"> </span>-t<span class="w"> </span><span class="p">|</span><span class="w"> </span>less<span class="w"> </span>-S
</pre></div>
</div>
<ul class="simple">
<li><p>how many reads are there in this BAM file?</p></li>
<li><p>make an index for the BAM file, and then load the BAM file into IGV</p></li>
<li><p>how many unmapped reads are there in this BAM file?</p></li>
<li><p>how many reads on the plus strand, how many on the minus?</p></li>
<li><p>how many reads are there on chromsome 21, between these coordinates:
21:33019966-33020000</p></li>
<li><p>are there sequences in the header that have no reads?</p></li>
</ul>
</section>
<section id="fastqc">
<h3>FastQC<a class="headerlink" href="#fastqc" title="Permalink to this heading">¶</a></h3>
<p>Generally the first, quick step for quality control (QC) of sequenced
files is to run FastQC on each FASTQ file. It’s pretty straightforward
to run, either through a GUI or from the command line. Try checking the
example FASTQ files from the fastq section above.</p>
<p><a class="reference external" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</a></p>
</section>
<section id="bedtools">
<h3>BEDTools<a class="headerlink" href="#bedtools" title="Permalink to this heading">¶</a></h3>
<p>Any time you’re working on genomic intervals, whether they’re stored in
BAM, BED, GTF, GFF, or VCF, you should be reaching for BEDTools. There
are many subprograms of BEDTools, and you’ll eventually want to
familiarize yourself with them all.</p>
<p>Aaron Quinlan, the author of BEDTools, has a tutorial available at
<a class="reference external" href="http://quinlanlab.org/tutorials/bedtools/bedtools.html">http://quinlanlab.org/tutorials/bedtools/bedtools.html</a>. It’s well worth
your time to go through this and understand how the tools work.
Especially useful are the “puzzles” at the end which will test your
knowledge.</p>
</section>
</section>
<section id="hints">
<h2>Hints<a class="headerlink" href="#hints" title="Permalink to this heading">¶</a></h2>
<p>How many reads in the fastq? <code class="docutils literal notranslate"><span class="pre">zcat</span> <span class="pre">sample1.tiny_R1.fastq.gz</span> <span class="pre">|</span> <span class="pre">wc</span> <span class="pre">-l</span></code>
gets the line count (using zcat to uncompress on the fly), but then we
need to divide by 4 since one record takes up 4 lines. A tricky way of
doing this all in one line is the following, which takes advantage of
echo’s arithmetic expansion with the $(()) syntax:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>zcat<span class="w"> </span>sample1.tiny_R1.fastq.gz<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="k">$((</span><span class="sb">`</span>wc<span class="w"> </span>-l<span class="sb">`</span><span class="o">/</span><span class="m">4</span><span class="k">))</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>To tie everything together, add examples of figures from papers, and
explain how all of these steps come together.</p>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>For genomics, write the following:</p>
<ul class="simple">
<li><p>Aligners (Bowtie2, HISAT2, BWA, STAR)?</p></li>
<li><p>Links to example RNA-seq and ChIP-seq workflows (possibly from
<a class="reference external" href="https://hbctraining.github.io/main/">https://hbctraining.github.io/main/</a>)</p></li>
<li><p>bedGraph, wig, bigBed, bigWig, chromsizes</p></li>
<li><p>example RNA-seq and ChIP-seq bash scripts scale that up to Snakemake
workflows?</p></li>
</ul>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Genomics overview</a><ul>
<li><a class="reference internal" href="#overviews">Overviews</a></li>
<li><a class="reference internal" href="#genome-browsers">Genome Browsers</a></li>
<li><a class="reference internal" href="#igv">IGV</a></li>
<li><a class="reference internal" href="#ucsc-genome-browser">UCSC Genome Browser</a></li>
<li><a class="reference internal" href="#other-genome-browsers">Other genome browsers</a></li>
<li><a class="reference internal" href="#file-formats">File formats</a><ul>
<li><a class="reference internal" href="#an-aside">An aside</a></li>
<li><a class="reference internal" href="#fastq">FASTQ</a></li>
<li><a class="reference internal" href="#bam">BAM</a></li>
<li><a class="reference internal" href="#bed">BED</a></li>
<li><a class="reference internal" href="#gtf-and-gff">GTF and GFF</a></li>
<li><a class="reference internal" href="#vcf">VCF</a></li>
</ul>
</li>
<li><a class="reference internal" href="#standard-tools">Standard tools</a><ul>
<li><a class="reference internal" href="#samtools">samtools</a></li>
<li><a class="reference internal" href="#fastqc">FastQC</a></li>
<li><a class="reference internal" href="#bedtools">BEDTools</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hints">Hints</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/genomics-formats.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form class="search" action="search.html" method="get">
  <input type="text" name="q"
   placeholder="type to search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="biology.html" title="Previous document">Biology</a>
        </li>
        <li>
          <a href="variant-calling.html" title="Next document">Variant calling</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">Home</a></li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; 2020, Ryan Dale.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a>
      6.1.3.

  </footer>

  
  </body>
</html>